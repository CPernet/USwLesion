function stats_analysis(csv_folder);

% csv_folder = '/home/cpernet/Documents/MATLAB/MyToolboxes/SPM/spm12/toolbox/USwLesion/validation/BT_analysis_pipe';


for d = 1:5
    if d==1
        name = ['Dice_results.csv']; nname = 'Dice';
    elseif d==2
        name = ['mHd_results.csv']; nname = 'Hansdorff';
    elseif d==3
        name = ['mj_results.csv']; nname = 'Jaccard';
    elseif d==4
           name = ['overlap_kappa_results.csv']; nname = 'Kappa';
    elseif d== 5
        name = ['overalap_mcc_results.csv']; nname = 'Matthew Corr';
    end
    
    IMP = importdata([csv_folder filesep name]);
    data = IMP.data;
    label = IMP.colheaders;
    clear IMP
    
% ranking the data in ascending order of similarity for each patient. for each overlap metric, sd is the sorted data and i is the index.

   figure
   subplot(2,1,1); [est,HDI] = rst_data_plot(data,'estimator','trimmed mean','newfig','no'); 
   title([nname ' Raw Data']);  
   % boostrap the data and rank
   subplot(2,1,2);
   [o,n] = size(data);
   med = NaN(n,599);
   for boot=1:599 % bootstrap loop
       theta = exprnd(1,[n,1]);
       weigths = theta ./ repmat(sum(theta),n,1);
       resample = (datasample(data',n,'Replace',true,'Weights',weigths));
       [~,index] = sort(resample,'descend');
       med(:,boot) = rst_hd(index',0.5);
   end
   rst_boxplot(med'); title([nname ' Ranked Data'])
    
   
   
   

rst_data_plot(sd_mHd);
rst_data_plot(sd_mcc);
rst_data_plot(sd_kappa);
rst_data_plot(sd_dice);

% clustering the data and visualising in a dendrogram 

T = clusterdata(MJ.','maxclust',3);
tree_mJ = linkage(T,'average');
figure();
dendrogram(tree_mJ);

T1 = clusterdata(MHD.','maxclust',3);
tree_mHd = linkage(T1,'average');
figure();
dendrogram(tree_mHd);

T2 = clusterdata(MCC.','maxclust',3);
tree_mcc = linkage(T2,'average');
figure();
dendrogram(tree_mcc);

T3 = clusterdata(KAPPA.','maxclust',3);
tree_kappa = linkage(T3,'average');
figure();
dendrogram(tree_kappa);

T4 = clusterdata(DICE.','maxclust',3);
tree_dice = linkage(T4,'average');
figure();
dendrogram(tree_dice);
